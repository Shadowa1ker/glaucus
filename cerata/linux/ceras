name=linux
version=4.18.13
release=1
description='The Linux kernel and modules'
arch=x86_64
url=https://cdn.kernel.org/pub/$name/kernel/v4.x/$name-$version.tar.xz
license=GPLv2
checksum=24fb002c0a519b4b01968c21bfd0e4cdabb3b8f6ed1adca8305703d1d01b16efa2461c16eb8ffc7b192733a9b249f73b7ffc617152cca1b0d3d141152ccff3a7

build_toolchain () {
	tar xfv $CERD/$name/$name-$version.tar.xz -C $TMPD/toolchain/sources
	cd $TMPD/toolchain/sources/$name-$version
	make mrproper
        make O=$TMPD/toolchain/builds/$name ARCH=$ARCH headers_check
        make O=$TMPD/toolchain/builds/$name ARCH=$ARCH INSTALL_HDR_PATH=$PRFX/$TRPL headers_install
}

build () {
	tar xfv $CERD/$name/$name-$version.tar.xz -C $TMPD/system/sources
	cd $TMPD/system/sources/$name-$version
	make mrproper
	cp $CERD/$name/glaucus.config .config
	make ARCH=$ARCH CROSS_COMPILE=$TRPL- oldconfig
	make ARCH=$ARCH CROSS_COMPILE=$TRPL- prepare
	make ARCH=$ARCH CROSS_COMPILE=$TRPL-
	make ARCH=$ARCH CROSS_COMPILE=$TRPL- INSTALL_PATH=$GLAD/boot install
}
