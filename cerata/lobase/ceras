name=lobase
version=git
release=1
arch=x86_64
url=https://$version.duncano.de/$name
cyst=mawk
description='A port of the OpenBSD userland to Linux'
license='ISC PD'
build(){
        rsync -vah $CERD/$name/$name $SSRC --delete
        cd $SSRC/$name
        sed -e 's/${DESTDIR}//' \
                -e 's/$$s//' \
                -e '10d' \
                -i mk/bsd.man.mk
        autoreconf -vfi
        ./configure \
                --prefix= \
                --build=$TUPL \
                --host=$TUPL \
                --target=$TUPL
        cd lib
        for dir in libopenbsd liboutil
        do
                cd $dir
                make
                cd ..
        done
        cd ../usr.bin
        for dir in diff fmt patch sort
        do
                cd $dir
                make
                make \
                        BINDIR=/bin \
                        DESTDIR=$SCER/$name/sac \
                        MANDIR=$SCER/$name/sac/share/man/man1 \
                        install
                cd ..
        done
        cd ../bin
        for dir in ls stty
        do
                cd $dir
                make
                make \
                        BINDIR=/bin \
                        DESTDIR=$SCER/$name/sac \
                        MANDIR=$SCER/$name/sac/share/man/man1 \
                        install
                cd ..
        done
        cd pax
        make
        install -v pax $SCER/$name/sac/bin
        install -m 444 -Dv cpio.1 pax.1 tar.1 -t $SCER/$name/sac/share/man/man1
        cd $SCER/$name/sac/bin
        ln -fsv pax cpio
        ln -fsv pax tar
}
