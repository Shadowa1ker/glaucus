name=mawk
version=git
release=1
arch=x86-64
url=https://github.com/ThomasDickey/$name-snapshots
cyst=musl
description='An interpreter for the AWK Programming Language faster than gawk'
cluster=core
license=GPLv2+

prepare_system() {
  mkdir -v $SBLD/$ceras
  cd $SBLD/$ceras
}

configure_system() {
  case $ceras in
    mawk_1)
      AWK=mawk \
      CFLAGS="$CFLAGSNOOPENMP" \
      $CERD/$name/$name-snapshots/configure \
        --prefix=/usr \
        --build=$TUPL \
        --host=$TUPL \
        --target=$TUPL
      ;;
    mawk_2)
      CFLAGS="$CFLAGSNOOPENMP" \
      $CERD/$name/$name-snapshots/configure \
        --prefix=/usr \
        --build=$TUPL \
        --host=$TUPL \
        --target=$TUPL
      ;;
  esac
}

build_system() {
  make
}

install_system() {
  rsync -vah $CERD/$name/$name-snapshots/man . --delete
  make \
    DESTDIR=$SCER/$ceras/sac \
    install

  cd $SCER/$ceras/sac/usr/bin
  ln -fsv $name awk
}
