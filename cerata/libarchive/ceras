name=libarchive
version=git
release=1
description='Multi-format archive and compression library'
arch=x86_64
url=https://github.com/$name/$name
license=BSDv3
build () {
        cp -arv $CERD/$name/$name $TMPD/system/sources
        cd $TMPD/system/sources/$name
        autoreconf -vfi
        mkdir -v $TMPD/system/builds/$name
        cd $TMPD/system/builds/$name
        AR=$AR \
        AS=$AS \
        AWK=$GLAD/bin/mawk \
        CC=$CC \
        CXX=$CXX \
        LD=$LD \
        NM=$NM \
        OBJDUMP=$OBJDUMP \
        RANLIB=$RANLIB \
        STRIP=$STRIP \
        CFLAGS="$CFLAGS" \
        CXXFLAGS="$CXXFLAGS" \
        LDFLAGS="$LDFLAGS" \
        $TMPD/system/sources/$name/configure \
                --prefix= \
                --disable-static \
                --disable-bsdtar \
                --disable-acl \
                --without-zstd \
                --without-cng \
                --without-nettle \
                --without-openssl \
                --without-xml2 \
                --without-expat
        make
        make \
                DESTDIR=$GLAD \
                install-strip
}
