name=musl
version=git
release=1
arch=x86_64
url=https://$version.$name-libc.org/c$version/$name
description='An implementation of the standard library functionality described in the ISO C and POSIX standards, plus common extensions, intended for use on Linux-based systems'
license='BSDv2 LGPLv2.1+ MIT PD'
build_toolchain(){
        mkdir -v $TBLD/$name
        cd $TBLD/$name
        $CERD/$name/$name/configure \
                CC=$TUPL-gcc \
                CROSS_COMPILE=$TUPL- \
                --prefix=/ \
                --target=$TUPL \
                --disable-debug \
                --disable-warnings
        make
        make \
                DESTDIR=$TOOL/$TUPL \
                install
}
build(){
        mkdir -v $SBLD/$name
        cd $SBLD/$name
        $CERD/$name/$name/configure \
                --prefix= \
                --target=$TUPL \
                --host=$TUPL \
                --build=$TUPL \
                --disable-debug \
                --disable-warnings \
                --disable-static \
                --without-libpam \
                --without-audit \
                --without-selinux \
                --without-nscd
        make
        make \
                DESTDIR=$SCER/$name/sac \
                install-libs
        install -dv $SCER/$name/sac/bin
        cd $SCER/$name/sac/bin
        ln -fsv ../lib/ld-musl-x86_64.so.1 ldd
        $STRIP -v $SCER/$name/sac/lib/Scrt1.o \
                $SCER/$name/sac/lib/crt1.o \
                $SCER/$name/sac/lib/crti.o \
                $SCER/$name/sac/lib/crtn.o \
                $SCER/$name/sac/lib/rcrt1.o
}
