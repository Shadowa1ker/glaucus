# Copyright (c) 2019, Firas Khalil Khana
# Distributed under the terms of the ISC License

export ARCH=x86_64
export TUPL=$ARCH-pc-linux-musl

export CERD=/cerata
export SCRD=/scripts
export SRCD=/sources

export SLOG=/logs/system/$(ls -l /logs/system | wc -l)
export SSCR=/scripts/system
export STMP=/temporary/system
export SBLD=$STMP/builds
export SCER=$STMP/cerata
export SSRC=$STMP/sources

export TOOL=/toolchain

export PATH=/usr/bin:/bin:$TOOL/bin

export MAKEFLAGS=-j12

export AR=gcc-ar
export NM=gcc-nm
export RANLIB=gcc-ranlib

export GCSE='-fgcse-sm -fgcse-las'
export GRAPHITE='-fgraphite-identity -floop-nest-optimize -floop-parallelize-all'
export IPA='-fipa-pta'
export IRA='-fira-loop-pressure'
export LTO='-flto'
export MARCH='-march=x86-64'
export OPENMP='-fopenmp'
export OPT='-Ofast'
export OTHER='-fmerge-all-constants -fdevirtualize-at-ltrans -fvariable-expansion-in-unroller'
export PGO='-ftracer -funroll-loops'
export SMS='-fmodulo-sched -fmodulo-sched-allow-regmoves'

#export CFLAGS="-pipe $OPENMP -g0 $OPT $SMS $GCSE $IRA $IPA $GRAPHITE $OTHER $LTO $PGO -s $MARCH"
#export CFLAGSNOLTO="-pipe $OPENMP -g0 $OPT $SMS $GCSE $IRA $IPA $GRAPHITE $OTHER $PGO -s $MARCH"
#export CFLAGSNOOPENMP="-pipe -g0 $OPT $SMS $GCSE $IRA $IPA $GRAPHITE $OTHER $LTO $PGO -s $MARCH"
export CFLAGS="-O2"
export CFLAGSNOLTO="-O2"
export CFLAGSNOOPENMP="-O2"
export CXXFLAGS="$CFLAGS"
#export LDFLAGS="-Wl,--strip-all -Wl,-z,now,-z,relro -Wl,--as-needed $CFLAGS"
export LDFLAGS="-Wl,-z,now,-z,relro -Wl,--as-needed $CFLAGS"
